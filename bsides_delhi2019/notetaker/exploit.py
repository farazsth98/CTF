#!/usr/bin/env python2

from pwn import *

context.arch = 'amd64'
context.terminal = ['tmux', 'new-window']

BINARY = './notetaker'
HOST, PORT = '35.226.111.216', 1111

elf = ELF(BINARY)
libc = ELF('./libc.so.6')

def debug(breakpoints):
    script = ""
    for bp in breakpoints:
        script += "b *0x%x\n"%(bp)
    gdb.attach(p,gdbscript=script)

def start():
    if not args.REMOTE:
        return process(BINARY)
    else:
        return remote(HOST, PORT)

def add(title, desc):
    p.sendlineafter('> ', '1')
    p.sendlineafter(': ', str(len(title)))
    p.sendafter(': ', title[:-1])
    p.sendlineafter(': ', str(len(desc)))
    p.sendafter(': ', desc[:-1])

def edit(idx, title, desc):
    p.sendlineafter('> ', '2')
    p.sendlineafter(': ', str(idx))
    p.sendafter(': ', title)
    p.sendafter(': ', desc)

def free(idx):
    p.sendlineafter('> ', '4')
    p.sendlineafter(': ', str(idx))

p = start()
if not args.REMOTE and args.GDB:
    debug([0x4009d5])

# Exploit goes here

add('A', 'A'*0x80)

p.interactive()
